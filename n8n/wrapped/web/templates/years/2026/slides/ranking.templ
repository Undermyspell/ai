package slides

import (
	"fmt"

	"github.com/michael/stammtisch-wrapped/web/templates/years/2026/viewmodels"
)

// Intro slide - the first welcome slide
templ Intro() {
	<div class="slide active flex-col items-center justify-center h-screen px-6 text-center" data-duration="5000">
		<div class="animate-on-enter animate-scale-in">
			<span class="text-8xl mb-4 block animate-float">ğŸº</span>
		</div>
		<h1 class="animate-on-enter animate-fade-in-up delay-300 text-5xl md:text-7xl font-bold text-biergold text-glow mb-4">
			STAMMTISCH
		</h1>
		<h2 class="animate-on-enter animate-fade-in-up delay-500 text-3xl md:text-5xl font-bold text-schaum mb-8">
			WRAPPED
		</h2>
		<p class="animate-on-enter animate-fade-in delay-700 text-2xl text-biergold-dark">
			2025
		</p>
		<div class="animate-on-enter animate-fade-in delay-1000 mt-12">
			<p class="text-schaum/70 text-lg">Dein Jahr in Zahlen</p>
			<div class="mt-4 animate-bounce">
				<span class="text-biergold text-2xl">â†“</span>
			</div>
		</div>
	</div>
}

// YearStats slide - Das groÃŸe Jahr in Zahlen
templ YearStats(stats viewmodels.YearStatsView) {
	<div class="slide flex-col items-center justify-center h-screen px-6 text-center" data-duration="7000">
		<h2 class="animate-on-enter animate-fade-in-up text-2xl md:text-3xl font-bold text-schaum mb-8">
			Das groÃŸe Stammtisch-Jahr
		</h2>
		<div class="grid grid-cols-2 gap-4 md:gap-6 max-w-md w-full">
			<!-- Donnerstage -->
			<div class="animate-on-enter animate-scale-in delay-200 bg-holz-light/50 rounded-2xl p-4 md:p-6">
				<span class="text-3xl mb-2 block">ğŸ“…</span>
				<span
					class="text-4xl md:text-5xl font-bold text-biergold block"
					data-count-to={ fmt.Sprintf("%d", stats.TotalThursdays) }
					data-count-duration="2000"
				>0</span>
				<span class="text-schaum/70 text-sm">Donnerstage</span>
			</div>
			<!-- Stammtischler -->
			<div class="animate-on-enter animate-scale-in delay-300 bg-holz-light/50 rounded-2xl p-4 md:p-6">
				<span class="text-3xl mb-2 block">ğŸ‘¥</span>
				<span
					class="text-4xl md:text-5xl font-bold text-biergold block"
					data-count-to={ fmt.Sprintf("%d", stats.TotalUsers) }
					data-count-duration="1500"
				>0</span>
				<span class="text-schaum/70 text-sm">Stammtischler</span>
			</div>
			<!-- Zusagen -->
			<div class="animate-on-enter animate-scale-in delay-400 bg-holz-light/50 rounded-2xl p-4 md:p-6">
				<span class="text-3xl mb-2 block">âœ…</span>
				<span
					class="text-4xl md:text-5xl font-bold text-green-500 block"
					data-count-to={ fmt.Sprintf("%d", stats.TotalAttendances) }
					data-count-duration="2500"
				>0</span>
				<span class="text-schaum/70 text-sm">Zusagen</span>
			</div>
			<!-- Absagen -->
			<div class="animate-on-enter animate-scale-in delay-500 bg-holz-light/50 rounded-2xl p-4 md:p-6">
				<span class="text-3xl mb-2 block">âŒ</span>
				<span
					class="text-4xl md:text-5xl font-bold text-red-400 block"
					data-count-to={ fmt.Sprintf("%d", stats.TotalCancellations) }
					data-count-duration="2500"
				>0</span>
				<span class="text-schaum/70 text-sm">Absagen</span>
			</div>
		</div>
		<!-- Durchschnittliche Teilnahmequote -->
		<div class="animate-on-enter animate-fade-in-up delay-700 mt-8 bg-biergold/20 rounded-2xl p-6 max-w-md w-full">
			<span class="text-xl text-schaum/70 block mb-2">ğŸ“ˆ Durchschnittliche Teilnahme</span>
			<span
				class="text-5xl md:text-6xl font-bold text-biergold text-glow"
				data-count-to={ fmt.Sprintf("%d", stats.AverageAttendanceRate) }
				data-count-suffix="%"
				data-count-duration="2000"
			>0%</span>
		</div>
	</div>
}

// RankingIntro slide
templ RankingIntro() {
	<div class="slide flex-col items-center justify-center h-screen px-6 text-center" data-duration="4000">
		<div class="animate-on-enter animate-scale-in">
			<span class="text-8xl mb-6 block">ğŸ†</span>
		</div>
		<h2 class="animate-on-enter animate-fade-in-up delay-300 text-3xl md:text-4xl font-bold text-biergold text-glow mb-4">
			Der ZuverlÃ¤ssigkeits-Score
		</h2>
		<p class="animate-on-enter animate-fade-in delay-500 text-xl text-schaum/70">
			Wer war wirklich da?
		</p>
	</div>
}

// RankingCard renders a single ranking card
templ RankingCard(user viewmodels.RankedUser) {
	<div class={ "animate-on-enter animate-slide-left " + user.DelayClass + " " + user.TierBgColor + " rounded-xl p-4 flex items-center gap-4" }>
		<div class="text-2xl w-10 text-center">
			if user.Rank <= 3 {
				{ user.RankDisplay }
			} else {
				<span class="text-schaum/50">{ user.RankDisplay }</span>
			}
		</div>
		<div class="flex-1">
			<div class="flex items-center gap-2 mb-1">
				<span class="text-xl">{ user.Emoji }</span>
				<span class="font-bold text-schaum">{ user.Name }</span>
			</div>
			<div class="text-xs text-schaum/60 mb-2">{ user.TitleEmoji } { user.Title }</div>
			<div class="w-full bg-holz rounded-full h-2">
				<div
					class={ user.BarColor + " h-2 rounded-full transition-all duration-1000" }
					style={ fmt.Sprintf("width: %d%%", user.AttendanceRate) }
				></div>
			</div>
		</div>
		<div class="text-right">
			<span class="text-2xl font-bold text-biergold">{ fmt.Sprintf("%d", user.AttendanceRate) }%</span>
		</div>
	</div>
}

// Top5 slide - Top 5 Ranking
templ Top5(users []viewmodels.RankedUser) {
	<div class="slide flex-col items-center justify-start h-screen px-4 pt-12 pb-6 overflow-y-auto" data-duration="8000">
		<h2 class="animate-on-enter animate-fade-in text-xl font-bold text-schaum mb-6">
			ğŸ¥‡ Top 5 â€“ Die ZuverlÃ¤ssigsten
		</h2>
		<div class="w-full max-w-md space-y-3">
			for _, user := range users {
				@RankingCard(user)
			}
		</div>
	</div>
}

// MidRanking slide - PlÃ¤tze 6-10
templ MidRanking(users []viewmodels.RankedUser) {
	<div class="slide flex-col items-center justify-start h-screen px-4 pt-12 pb-6 overflow-y-auto" data-duration="6000">
		<h2 class="animate-on-enter animate-fade-in text-xl font-bold text-schaum mb-6">
			ğŸ“Š PlÃ¤tze 6-10
		</h2>
		<div class="w-full max-w-md space-y-3">
			for _, user := range users {
				@RankingCard(user)
			}
		</div>
	</div>
}

// BottomRanking slide - PlÃ¤tze 11-15
templ BottomRanking(users []viewmodels.RankedUser) {
	<div class="slide flex-col items-center justify-start h-screen px-4 pt-12 pb-6 overflow-y-auto" data-duration="6000">
		<h2 class="animate-on-enter animate-fade-in text-xl font-bold text-schaum mb-6">
			ğŸ“‰ PlÃ¤tze 11-15 â€“ Raum nach oben
		</h2>
		<div class="w-full max-w-md space-y-3">
			for _, user := range users {
				@RankingCard(user)
			}
		</div>
	</div>
}
